;
(function(win,doc){var isIE=!!window.ActiveXObject;var isIE6=isIE&&!window.XMLHttpRequest;var v=0,vc=0;var jsonpf="";function $el(e){return typeof e==="string"?document.getElementById(e):e}Object.extend=function(e,t){for(var i in t){e[i]=t[i]}return e};function addEvent(e,t,i){if(e.attachEvent){e["e"+t+i]=i;e[t+i]=function(){e["e"+t+i](win.event)};e.attachEvent("on"+t,e[t+i])}else e.addEventListener(t,i,false)}var AjaxP=function(){function load(url,opt){var randStr=Math.random().toString();var self=arguments.callee,head=doc.getElementsByTagName("head")[0],data=opt.data,success=opt.success,cache="&nocache="+(new Date).getTime();randStr="jsonp"+randStr.substring(2,randStr.length);jsonpf="function "+randStr+"(data){"+"return scuess(data,"+success+")"+"}";eval(jsonpf);eval("win."+randStr+"=eval("+randStr+")");var src=url+=(url.indexOf("?")==-1?"?":"&")+data+"&callback="+randStr+cache;self.Script&&self.Script.parentNode.removeChild(self.Script);self.Script=doc.createElement("script");self.Script.type="text/javascript";self.Script.onload=self.Script.onreadystatechange=function(){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){self.Script.onload=self.Script.onreadystatechange=null;return eval(randStr)}else{self.Script.onload=function(){return eval(randStr)}}};self.Script.src=src;head.appendChild(self.Script)}function scuess(e,t){var i=$el("CS_Popup_errtip");var s=$el("secimg");if(e.error===0){return t({error:0,uid:e.uid})}else if(e.error===2||e.error===5){if(vc){checkLogin.refreshVerifyCode(s)}else{vc=1;checkLogin.secodesh(1)}}else if(e.error===3){var n=$el("seccode_panel");if(n.style.display=="none"){vc=1;checkLogin.secodesh(1);i.innerHTML="为了安全，系统要求您输入验证码";$el("CS_Popup_seccode").focus()}else{checkLogin.refreshVerifyCode(s);i.innerHTML=e.info}}else{checkLogin.secodesh(0);i.innerHTML=e.info}}return{load:load}}();var checkLogin=function(){function e(e){var i=e.xhrback,s=e.xhrUrl,r=e.xhrparam;var c=$el("CS_Popup_uid");var d=$el("CS_Popup_pwd");var p=$el("CS_Popup_errtip");var h=n(c.value),u=d.value;if(h==""){l(p,"请输入你的登录帐号！",c);return false}else{if(o(h)){if(h<1e4||h>1e11){l(p,"你输入的帐号错误！",c);return false}}else{if(h.indexOf("@")>-1){if(!a(h)){l(p,"你输入的帐号错误！",c);return false}}else{var f=/^[\da-zA-Z_]+$/;if(!f.test(h)){l(p,"您输入的帐号错误！",c);return false}}l(p,"&nbsp;",d)}}if(u==""){l(p,"请输入您的密码！",d);return false}else{l(p,"&nbsp;",c)}var v="uid="+h+"&password="+u+"&"+r;if(vc){var g=$el("CS_Popup_seccode");var m=n(g.value);if(""==m){l(p,"请输入验证码！",g);return false}if(m.length>4){l(p,"验证码超过长度！",g);return false}v+="&seccode="+m}t(v,i,s)}function t(e,t,i){AjaxP.load(i,{data:e,success:t})}function i(t,i,s){var n=$el("CS_Popup_uid"),a=$el("CS_Popup_pwd"),o=$el("CS_Popup_seccode");addEvent(n,"keydown",function(e){l(e)});addEvent(a,"keydown",function(e){l(e)});addEvent(o,"keydown",function(e){l(e)});function l(n){if(n.keyCode==13){e({xhrback:t,xhrUrl:i,xhrparam:s})}}}function s(e){var t=$el("seccode_panel"),i=$el("CS_Popup_yz_area"),s=$el("CS_Popup_seccode");if(e){if(t){t.style.display="block";addEvent(s,"focus",function(){if(i.style.display!="block"){i.style.display="block";var e='<img class="secimg" id="secimg" style="cursor:pointer;" alt="看不清楚？点击换一张" title="看不清楚？点击换一张" /> <span><a href="javascript:;" id="reload_atag">看不清，换一张</a></span>';i.innerHTML=e;var t=$el("secimg"),s=$el("reload_atag");addEvent(t,"click",function(e){r(t,e)});addEvent(s,"click",function(e){r(t,e)});r(t)}})}vc=1}else if(!e){if(t){t.style.display="none";i.style.display="none";i.innerHTML=""}vc=0}}function n(e){return e.replace(/(^\s*)|(\s*$)/g,"")}function a(e){var t=/^[a-zA-Z0-9]+([\._-][a-zA-Z0-9]+)*@(([a-zA-Z0-9]+([\.-][a-zA-Z0-9]+)?)+\.)+[a-zA-Z]+$/;return t.test(e)}function o(e){var t=/^(0|[1-9][0-9]*)$/;return t.test(e)}function l(e,t,i){e.innerHTML=t;i.focus();return}function r(e,t){t=t||win.event||{};t.preventDefault&&t.preventDefault()||(t.returnValue=false);t.stopPropagation&&t.stopPropagation()||(t.cancelBubble=true);if(e){if($el("CS_Popup_uid")){var i=n($el("CS_Popup_uid").value)}else{return false}$el("CS_Popup_seccode").value="";$el("CS_Popup_seccode").focus();e=$el("secimg");if(e){e.setAttribute("src","http://login.2125.com/?c=new_loginses&d=changeVerify&userid="+i+"&rnd="+Math.random());return false}}}return{check:e,secodesh:s,bindUid:i,refreshVerifyCode:r}}();function CsPopup(){this.init.apply(this,arguments)}CsPopup.prototype={init:function(e,t,i){var s=this;this.PopID=t;this.EventCopy(i);this.CTitle=this.options.title||null;this.CContent=this.options.content||null;this.CBtns=this.options.btns||null;this.CWidth=this.options.width||350;this.fixed=this.options.fixed||false;this.zIndex=this.options.zindex||999;this.overlay=this.options.overlay||true;this.loginback=this.options.loginback||null;this.param=this.options.loginparam||{};this.regparam=this.options.regparam||{};this.ajaxurl=this.options.ajaxurl||"http://login.2125.com/?c=loginses&d=index";var n=typeof this.param=="object"&&Object.prototype.toString.call(this.param).toLowerCase()=="[object object]"&&!this.param.length;var a=typeof this.regparam=="object"&&Object.prototype.toString.call(this.regparam).toLowerCase()=="[object object]"&&!this.regparam.length;if(!n){alert("传入的自定义参数不是json格式");return}else{var o="";for(var l in this.param){o+=l+"="+this.param[l]+"&"}o=o.substring(0,o.length-1);this.param=o}if(!a){alert("传入的自定义注册参数不是json格式");return}else{var r="";for(var l in this.regparam){r+=l+"="+this.regparam[l]+"&"}r=r.substring(0,r.length-1);if(r.length>0)r="?"+r;this.regparam=r}if($el(e)){this.obj=$el(e);this.obj.onclick=function(){s.create()}}else{if(t){s.create()}else{return}}},create:function(){var e=this;this.PopID==""?"CS_Popup_Cbox":this.PopID;if(this.overlay){this.OverLay(true)}this.PopDiv=doc.createElement("div");this.PopDiv.id=this.PopID;this.PopDiv.className="pop_box";var t=new Array;if(this.CTitle){t.push('<div class="pop_title"><div class="css_bg tlr"></div><h2 class="css_bg t_txt" style="width:'+(this.CWidth-20)+'px">'+this.CTitle+'<a href="javascript:;" class="css_bg pop_colse" id="'+this.PopID+'_colse" hidefocus="true"></a></h2><div class="css_bg tlr r"></div></div>')}else{t.push('<div class="pop_title"><div class="css_bg tlr"></div><h2 class="css_bg t_txt" style="width:'+(this.CWidth-20)+'px">登  录<a href="javascript:;" class="css_bg pop_colse" id="'+this.PopID+'_colse" hidefocus="true"></a></h2><div class="css_bg tlr r"></div></div>')}t.push('<div class="pop_main">');if(this.CContent){t.push(this.CContent)}else{t.push('<p id="CS_Popup_errtip" class="CS_Popup_errtip">&nbsp;</p>');if(this.param.length>0){t.push('<div class="field"><label class="mm">帐号：</label><input name="uid" id="CS_Popup_uid" class="txt" type="text" tabindex="1001" maxLength="64"/><a href="http://account.61.com/register'+this.regparam+'" target="_blank" class="blue">申请米米号</a></div>')}else{t.push('<div class="field"><label class="mm">帐号：</label><input name="uid" id="CS_Popup_uid" class="txt" type="text" tabindex="1001" maxLength="64"/><a href="http://account.61.com/register" target="_blank" class="blue">申请米米号</a></div>')}t.push('<div class="field"><label class="mm">密码：</label><input class="txt" name="password" id="CS_Popup_pwd" type="password" tabindex="1002" maxlength="16"/><a href="http://account.61.com/forget/" target="_blank"  class="blue">忘记密码</a></div>');t.push('<div id="seccode_panel" style="display:none;"><div class="field"><label class="mm">验证码：</label><input name="seccode" id="CS_Popup_seccode" class="txt yz" type="text" tabindex="1003" autocomplete="off" maxlength="4"/></div>');t.push('<div id="CS_Popup_yz_area" class="yanzh" style="display:none"></div></div>')}t.push('<div class="pop_btns" id="'+this.PopID+'_pop_btns">');t.push("</div></div>");t.push('<div class="btm"><div class="css_bg blr"></div><div class="btmb" style="width:'+(this.CWidth-20)+'px"></div><div class="css_bg blr cbr"></div></div>');var i=t.join("");this.PopDiv.innerHTML=i;if($el(this.PopID)){return}else{doc.body.appendChild(this.PopDiv)}var s=$el(this.PopID+"_pop_btns");if(this.CBtns&&this.CContent){for(var n in this.CBtns){for(var a=0;a<1;a++){if(typeof this.CBtns[n][a]==="string"){var o=doc.createElement("a");o.className="css_bg btn";o.innerHTML=this.CBtns[n][a];o.setAttribute("href","javascript:;");o.setAttribute("hidefocus","true");if(typeof this.CBtns[n][a+1]==="function"){addEvent(o,"click",this.CBtns[n][a+1])}else{addEvent(o,"click",function(){e.close()})}s.appendChild(o)}}}}else if(this.CContent){s.innerHTML='<a id="pop_cancel" href="javascript:;" class="css_bg btn" hidefocus="true">确 定</a>';$el("pop_cancel").onclick=function(){e.close()}}else{s.innerHTML='<span id="CS_Popup_ajax_login" class="css_bg btn CS_lgnbtn">登 录</span>';if(this.loginback){checkLogin.bindUid(e.loginback,e.ajaxurl,e.param);$el("CS_Popup_ajax_login").onclick=function(){checkLogin.check({xhrback:e.loginback,xhrUrl:e.ajaxurl,xhrparam:e.param})}}else{alert("对不起，您未设置登录验证返回函数！")}}var l=this.PopDiv.style;l.width=this.CWidth+"px";l.zIndex=this.zIndex;l.position="absolute";l.left="50%";var r=0;if(window.innerHeight){r=window.innerHeight}else if(doc.body&&doc.body.clientHeight){r=doc.body.clientHeight}if(doc.documentElement&&doc.documentElement.clientHeight&&doc.documentElement.clientWidth){r=doc.documentElement.clientHeight}var c=this.PopDiv.offsetHeight;if(document.documentElement&&document.documentElement.scrollTop){var d=doc.documentElement.scrollTop-100}else if(document.body){var d=doc.body.scrollTop-100}var p=(r-c)/2+d;l.top=p+"px";l.marginLeft=-this.PopDiv.offsetWidth/2+"px";var h=$el(this.PopID+"_colse");h.onclick=function(){e.close()};v++},EventCopy:function(e){this.options={};Object.extend(this.options,e||{})},close:function(){var e=$el(this.PopID);if(e){doc.body.removeChild(e);e=null;v--}if(v==0){this.OverLay(false)}},OverLay:function(e){var t=doc.getElementsByTagName("select");var i=$el("OverLay");if(e){if(!i){var s=doc.createElement("div");s.id="OverLay";var n=s.style;if(isIE6){o();addEvent(win,"resize",o)}else{n.width=n.height="100%"}n.position=!isIE6?"fixed":"absolute";n.top=n.left=0;n.backgroundColor="#000";n.zIndex=this.zIndex-2;if(isIE){n.filter="alpha(opacity=40)"}else{n.opacity="0.4"}doc.body.appendChild(s);for(var a=0;a<t.length;a++){t[a].style.visibility="hidden"}}function o(){n.width=Math.max(doc.documentElement.scrollWidth,doc.documentElement.clientWidth)+"px";n.height=Math.max(doc.documentElement.scrollHeight,doc.documentElement.clientHeight)+20+"px"}}else{if(i){doc.body.removeChild(i);i=null;for(var a=0;a<t.length;a++){t[a].style.visibility="visible"}}}}};win.CsPopup=CsPopup})(window,document);function logout(e){e.preventDefault();$.ajax({url:"http://login.2125.com/?c=new_loginses&d=logout",type:"GET",dataType:"jsonp",jsonp:"callback",success:function(e){location.reload()}})}